from django import forms
from django.contrib.auth.forms import AuthenticationForm
from django.forms import TextInput, PasswordInput
from .models import Exploit, ExploitFile

class ExploitForm(forms.ModelForm):
    files = forms.FileField(widget=forms.ClearableFileInput(attrs={'multiple': True}), required=False)
    folders = forms.FileField(widget=forms.ClearableFileInput(attrs={'multiple': True, 'webkitdirectory': True}), required=False)
    description = forms.CharField(widget=forms.HiddenInput())

    class Meta:
        model = Exploit
        fields = ['title', 'category', 'CVSS', 'platform', 'CVE_ID', 'description']
        widgets = {
            'title': forms.TextInput(attrs={'placeholder': 'Enter title'}),
            'category': forms.Select(choices=Exploit.CATEGORY_CHOICES),
            'CVSS': forms.NumberInput(attrs={'placeholder': 'Enter CVSS score'}),
            'platform': forms.TextInput(attrs={'placeholder': 'Enter platform'}),
            'CVE_ID': forms.TextInput(attrs={'placeholder': 'Enter CVE ID'}),
            'description': forms.Textarea(attrs={'placeholder': 'Enter description'}),
        }

class ExploitFileForm(forms.ModelForm):
    class Meta:
        model = ExploitFile
        fields = ['file']

class LoginForm(AuthenticationForm):
    username = forms.CharField(widget=TextInput(attrs={'autocomplete': 'off'}))
    password = forms.CharField(widget=PasswordInput(attrs={'autocomplete': 'off'}))