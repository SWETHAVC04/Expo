<!-- This is a partial template for rendering a single node in the folder tree -->
<!-- Save this as "partials/folder_tree_node.html" in your templates directory -->

{% if node.name != "root" %}
<div class="folder-node">
  <div class="folder-header {% if level > 2 %}collapsed{% endif %}">
    <i class="fas fa-folder folder-icon"></i>
    <span class="folder-name">{{ node.name }}</span>
    {% if node.children or node.files %}
      <i class="fas fa-chevron-down toggle-icon"></i>
    {% endif %}
  </div>
  
  <div class="folder-content" {% if level > 2 %}style="max-height: 0;"{% endif %}>
{% endif %}

<!-- Render files in this folder -->
{% if node.files %}
  <ul class="file-list">
    {% for file in node.files %}
      <li class="file-item">
        <div class="file-info">
          {% with ext=file.name %}
            {% if ext.1 == "py" %}
              <i class="fab fa-python file-icon"></i>
            {% elif ext.1 == "js" %}
              <i class="fab fa-js file-icon"></i>
            {% elif ext.1 == "html" %}
              <i class="fab fa-html5 file-icon"></i>
            {% elif ext.1 == "css" %}
              <i class="fab fa-css3-alt file-icon"></i>
            {% elif ext.1 == "md" %}
              <i class="fas fa-file-alt file-icon"></i>
            {% elif ext.1 == "pdf" %}
              <i class="fas fa-file-pdf file-icon"></i>
            {% elif ext.1 == "zip" or ext.1 == "rar" or ext.1 == "tar" or ext.1 == "gz" %}
              <i class="fas fa-file-archive file-icon"></i>
            {% elif ext.1 == "jpg" or ext.1 == "png" or ext.1 == "gif" or ext.1 == "svg" %}
              <i class="fas fa-file-image file-icon"></i>
            {% else %}
              <i class="fas fa-file-code file-icon"></i>
            {% endif %}
          {% endwith %}
          <a href="{{ file.url }}" class="file-name">{{ file.name }}</a>
        </div>
        <div class="file-actions">
          <a href="{{ file.url }}" class="file-btn view-btn">
            <i class="fas fa-eye"></i> View
          </a>
          <a href="{{ file.url }}"></a>
        </div>
      </li>
    {% endfor %}
  </ul>
{% endif %}

<!-- Render child folders recursively -->
{% if node.children %}
  {% for child_name, child_node in node.children.items %}
    {% with node=child_node level=level|add:1 %}
      {% include "partials/folder_tree_node.html" %}
    {% endwith %}
  {% endfor %}
{% endif %}

{% if node.name != "root" %}
  </div>
</div>
{% endif %}